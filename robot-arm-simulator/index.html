<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¦‚å½±éšå½¢ - æœºæ¢°è‡‚æ§åˆ¶æ¨¡æ‹Ÿå™¨</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Orbitron', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            background: linear-gradient(180deg, #0a0e27 0%, #1a1f4b 50%, #0d1235 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
            touch-action: none;
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        .header {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0, 245, 255, 0.1);
            border-bottom: 1px solid rgba(0, 245, 255, 0.2);
        }

        .back-btn {
            color: #00f5ff;
            text-decoration: none;
            font-size: 1.2rem;
            margin-right: 15px;
        }

        .title {
            font-size: 1.1rem;
            font-weight: 700;
            background: linear-gradient(90deg, #00f5ff, #ff6b35);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* çŸ¥è¯†ç‚¹å¡ç‰‡æ»‘åŠ¨åŒº */
        .knowledge-slider {
            display: flex;
            overflow-x: auto;
            padding: 15px;
            gap: 15px;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
        }

        .knowledge-slider::-webkit-scrollbar {
            display: none;
        }

        .knowledge-card {
            flex: 0 0 85%;
            background: rgba(0, 245, 255, 0.05);
            border: 1px solid rgba(0, 245, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            scroll-snap-align: center;
        }

        .knowledge-card h3 {
            color: #00f5ff;
            font-size: 1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .knowledge-card p {
            color: #8892b0;
            font-size: 0.85rem;
            line-height: 1.6;
        }

        .knowledge-icon {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #ff6b35, #ff8c42);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        /* æœºæ¢°è‡‚å¯è§†åŒ–åŒº */
        .robot-display {
            position: relative;
            height: 280px;
            margin: 15px;
            background: rgba(10, 20, 40, 0.6);
            border-radius: 20px;
            border: 1px solid rgba(0, 245, 255, 0.2);
            overflow: hidden;
        }

        #robot-canvas {
            width: 100%;
            height: 100%;
        }

        /* ä»»åŠ¡ç›®æ ‡ */
        .task-target {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 107, 53, 0.2);
            border: 1px solid rgba(255, 107, 53, 0.5);
            border-radius: 10px;
            padding: 10px 15px;
            font-size: 0.8rem;
        }

        .task-target span {
            color: #ff6b35;
            font-weight: 700;
        }

        /* æ“ä½œæ†æ§åˆ¶åŒº */
        .control-area {
            margin: 15px;
            padding: 20px;
            background: rgba(0, 245, 255, 0.05);
            border-radius: 20px;
            border: 1px solid rgba(0, 245, 255, 0.2);
        }

        .control-label {
            text-align: center;
            color: #00f5ff;
            font-size: 0.9rem;
            margin-bottom: 15px;
            letter-spacing: 2px;
        }

        .joystick-area {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            border: 2px solid rgba(0, 245, 255, 0.3);
        }

        .joystick-base {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(0, 245, 255, 0.2) 0%, transparent 70%);
            border-radius: 50%;
        }

        .joystick-handle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #ff6b35, #ff8c42);
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.6);
            cursor: pointer;
            transition: transform 0.1s ease;
        }

        /* ç³»ç»Ÿæµç¨‹æ˜¾ç¤º */
        .system-flow {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
        }

        .system-node {
            text-align: center;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 0.75rem;
            transition: all 0.3s ease;
        }

        .system-node.active {
            background: rgba(0, 245, 255, 0.3);
            border: 1px solid rgba(0, 245, 255, 0.5);
            box-shadow: 0 0 15px rgba(0, 245, 255, 0.4);
        }

        .system-node.inactive {
            background: rgba(100, 100, 100, 0.2);
            border: 1px solid rgba(100, 100, 100, 0.3);
            color: #666;
        }

        .system-arrow {
            color: #00f5ff;
            font-size: 1.2rem;
        }

        /* å‰ç¥¥ç‰©åŒºåŸŸ */
        .mascot-area {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 15px;
            padding: 15px;
            background: rgba(55, 66, 250, 0.1);
            border-radius: 20px;
            border: 1px solid rgba(55, 66, 250, 0.3);
        }

        .mascot-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #3742fa, #2f3542);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 0 20px rgba(55, 66, 250, 0.5);
        }

        .mascot-speech {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 12px 15px;
            position: relative;
        }

        .mascot-speech::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 50%;
            transform: translateY(-50%);
            border: 8px solid transparent;
            border-right-color: rgba(255, 255, 255, 0.1);
        }

        .mascot-speech p {
            color: #fff;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        /* åˆ†æ•°æ˜¾ç¤º */
        .score-display {
            position: fixed;
            top: 80px;
            right: 15px;
            background: rgba(255, 107, 53, 0.2);
            border: 1px solid rgba(255, 107, 53, 0.5);
            border-radius: 10px;
            padding: 10px 15px;
            font-size: 0.9rem;
        }

        .score-display span {
            color: #ff6b35;
            font-weight: 700;
            font-size: 1.2rem;
        }

        /* å¼€å§‹æŒ‰é’® */
        .start-btn {
            display: block;
            width: calc(100% - 30px);
            margin: 15px;
            padding: 18px;
            background: linear-gradient(90deg, #ff6b35, #ff8c42);
            border: none;
            border-radius: 30px;
            color: #fff;
            font-size: 1.1rem;
            font-weight: 700;
            letter-spacing: 3px;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(255, 107, 53, 0.4);
        }

        .start-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <div class="header">
        <a href="../index.html" class="back-btn">â†</a>
        <span class="title">å¦‚å½±éšå½¢ - æœºæ¢°è‡‚æ§åˆ¶</span>
    </div>

    <!-- çŸ¥è¯†ç‚¹å¡ç‰‡ -->
    <div class="knowledge-slider">
        <div class="knowledge-card">
            <h3><span class="knowledge-icon">ğŸ‘ï¸</span>æ„Ÿå—å™¨</h3>
            <p>æœºæ¢°è‡‚çš„"æ„Ÿå®˜"ï¼Œé è§†è§‰ã€åŠ›è§‰ã€ä½ç½®ç­‰ä¼ æ„Ÿå™¨ï¼Œå®æ—¶æ„ŸçŸ¥è‡ªèº«çŠ¶æ€å’Œå‘¨å›´ç¯å¢ƒï¼Œä¸ºåŠ¨ä½œæ§åˆ¶æä¾›ä¾æ®ã€‚</p>
        </div>
        <div class="knowledge-card">
            <h3><span class="knowledge-icon">ğŸ§ </span>å¤„ç†å™¨</h3>
            <p>æœºæ¢°è‡‚çš„"å¤§è„‘"ï¼Œç»“åˆé¢„è®¾ç¨‹åºå’Œä¼ æ„Ÿå™¨æ•°æ®ï¼Œå¿«é€Ÿè®¡ç®—å‡ºæ¯ä¸ªå…³èŠ‚å¦‚ä½•è¿åŠ¨ï¼Œè§„åˆ’æœ€ä¼˜è·¯å¾„ã€‚</p>
        </div>
        <div class="knowledge-card">
            <h3><span class="knowledge-icon">ğŸ’ª</span>æ‰§è¡Œå™¨</h3>
            <p>æœºæ¢°è‡‚çš„"è‚Œè‚‰"ï¼Œé€šå¸¸æ˜¯ç”µæœºæˆ–æ¶²å‹è£…ç½®ï¼Œæ”¶åˆ°æŒ‡ä»¤åäº§ç”Ÿç²¾å‡†åŠ›é‡å’Œè¿åŠ¨ï¼Œå®ŒæˆæŠ“å–ä»»åŠ¡ã€‚</p>
        </div>
    </div>

    <!-- åˆ†æ•°æ˜¾ç¤º -->
    <div class="score-display">
        å¾—åˆ†: <span id="score">0</span>
    </div>

    <!-- æœºæ¢°è‡‚å¯è§†åŒ– -->
    <div class="robot-display">
        <canvas id="robot-canvas"></canvas>
        <div class="task-target">
            ç›®æ ‡: <span>æŠ“å–æ©™è‰²æ–¹å—</span>
        </div>
    </div>

    <!-- ç³»ç»Ÿæµç¨‹ -->
    <div class="system-flow">
        <div class="system-node active" id="node-sensor">æ„Ÿå—å™¨</div>
        <span class="system-arrow">â†’</span>
        <div class="system-node inactive" id="node-processor">å¤„ç†å™¨</div>
        <span class="system-arrow">â†’</span>
        <div class="system-node inactive" id="node-actuator">æ‰§è¡Œå™¨</div>
    </div>

    <!-- æ“ä½œæ†æ§åˆ¶ -->
    <div class="control-area">
        <div class="control-label">æ‹–åŠ¨æ§åˆ¶æœºæ¢°è‡‚</div>
        <div class="joystick-area" id="joystick-area">
            <div class="joystick-base"></div>
            <div class="joystick-handle" id="joystick-handle"></div>
        </div>
    </div>

    <!-- å‰ç¥¥ç‰© -->
    <div class="mascot-area">
        <div class="mascot-avatar">ğŸ¤–</div>
        <div class="mascot-speech">
            <p id="mascot-text">ä½ å¥½ï¼æˆ‘æ˜¯ç§‘å¥‡ï¼Œå¿«æ¥ä½“éªŒæœºæ¢°è‡‚æ§åˆ¶çš„å¥¥ç§˜å§ï¼æ‹–åŠ¨ä¸‹æ–¹çš„æ“ä½œæ†ï¼Œæ§åˆ¶æœºæ¢°è‡‚æŠ“å–ç›®æ ‡ç‰©ä½“ã€‚</p>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        let score = 0;
        let joystickX = 0;
        let joystickY = 0;
        let isDragging = false;
        let armAngle = 0;
        let targetX = 0;
        let targetY = 0;
        let grabbed = false;

        // åˆå§‹åŒ–ç”»å¸ƒ
        const canvas = document.getElementById('robot-canvas');
        const ctx = canvas.getContext('2d');
        
        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            targetX = canvas.width * 0.7;
            targetY = canvas.height * 0.6;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // æ‘‡æ†æ§åˆ¶
        const joystickArea = document.getElementById('joystick-area');
        const joystickHandle = document.getElementById('joystick-handle');
        const centerX = 75;
        const centerY = 75;
        const maxRadius = 40;

        function updateJoystick(clientX, clientY) {
            const rect = joystickArea.getBoundingClientRect();
            const x = clientX - rect.left - centerX;
            const y = clientY - rect.top - centerY;
            
            const distance = Math.sqrt(x * x + y * y);
            const angle = Math.atan2(y, x);
            
            const clampedDistance = Math.min(distance, maxRadius);
            
            joystickX = (Math.cos(angle) * clampedDistance) / maxRadius;
            joystickY = (Math.sin(angle) * clampedDistance) / maxRadius;
            
            const handleX = Math.cos(angle) * clampedDistance;
            const handleY = Math.sin(angle) * clampedDistance;
            
            joystickHandle.style.transform = `translate(calc(-50% + ${handleX}px), calc(-50% + ${handleY}px))`;
            
            // æ›´æ–°ç³»ç»Ÿæµç¨‹æ˜¾ç¤º
            updateSystemFlow();
        }

        function updateSystemFlow() {
            const sensor = document.getElementById('node-sensor');
            const processor = document.getElementById('node-processor');
            const actuator = document.getElementById('node-actuator');
            
            if (Math.abs(joystickX) > 0.1 || Math.abs(joystickY) > 0.1) {
                sensor.classList.add('active');
                sensor.classList.remove('inactive');
                
                setTimeout(() => {
                    processor.classList.add('active');
                    processor.classList.remove('inactive');
                }, 100);
                
                setTimeout(() => {
                    actuator.classList.add('active');
                    actuator.classList.remove('inactive');
                }, 200);
            } else {
                [sensor, processor, actuator].forEach(node => {
                    node.classList.remove('active');
                    node.classList.add('inactive');
                });
            }
        }

        // è§¦æ‘¸/é¼ æ ‡äº‹ä»¶
        joystickHandle.addEventListener('touchstart', (e) => {
            isDragging = true;
            e.preventDefault();
        });

        joystickHandle.addEventListener('mousedown', () => {
            isDragging = true;
        });

        document.addEventListener('touchmove', (e) => {
            if (isDragging) {
                updateJoystick(e.touches[0].clientX, e.touches[0].clientY);
            }
        });

        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                updateJoystick(e.clientX, e.clientY);
            }
        });

        document.addEventListener('touchend', () => {
            isDragging = false;
            resetJoystick();
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            resetJoystick();
        });

        function resetJoystick() {
            joystickX = 0;
            joystickY = 0;
            joystickHandle.style.transform = 'translate(-50%, -50%)';
            updateSystemFlow();
        }

        // ç»˜åˆ¶æœºæ¢°è‡‚
        function drawRobot() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            
            // åº•åº§
            ctx.fillStyle = '#3742fa';
            ctx.fillRect(centerX - 30, centerY + 80, 60, 20);
            
            // æœºæ¢°è‡‚ç¬¬ä¸€æ®µ
            const arm1Length = 80;
            const arm1Angle = joystickX * 0.5;
            const arm1EndX = centerX + Math.sin(arm1Angle) * arm1Length;
            const arm1EndY = centerY + 80 - Math.cos(arm1Angle) * arm1Length;
            
            ctx.strokeStyle = '#00f5ff';
            ctx.lineWidth = 8;
            ctx.lineCap = 'round';
            ctx.beginPath();
            ctx.moveTo(centerX, centerY + 80);
            ctx.lineTo(arm1EndX, arm1EndY);
            ctx.stroke();
            
            // å…³èŠ‚
            ctx.fillStyle = '#ff6b35';
            ctx.beginPath();
            ctx.arc(arm1EndX, arm1EndY, 10, 0, Math.PI * 2);
            ctx.fill();
            
            // æœºæ¢°è‡‚ç¬¬äºŒæ®µ
            const arm2Length = 60;
            const arm2Angle = arm1Angle + joystickY * 0.5;
            const arm2EndX = arm1EndX + Math.sin(arm2Angle) * arm2Length;
            const arm2EndY = arm1EndY - Math.cos(arm2Angle) * arm2Length;
            
            ctx.strokeStyle = '#ff6b35';
            ctx.beginPath();
            ctx.moveTo(arm1EndX, arm1EndY);
            ctx.lineTo(arm2EndX, arm2EndY);
            ctx.stroke();
            
            // çˆªå­
            ctx.fillStyle = '#ffd700';
            ctx.beginPath();
            ctx.arc(arm2EndX, arm2EndY, 8, 0, Math.PI * 2);
            ctx.fill();
            
            // ç›®æ ‡ç‰©ä½“
            if (!grabbed) {
                ctx.fillStyle = '#ff6b35';
                ctx.fillRect(targetX - 15, targetY - 15, 30, 30);
                
                // æ£€æµ‹æŠ“å–
                const dist = Math.sqrt(Math.pow(arm2EndX - targetX, 2) + Math.pow(arm2EndY - targetY, 2));
                if (dist < 20) {
                    grabbed = true;
                    score += 100;
                    document.getElementById('score').textContent = score;
                    document.getElementById('mascot-text').textContent = 'å¤ªæ£’äº†ï¼æˆåŠŸæŠ“å–ç›®æ ‡ï¼å¾—åˆ†+' + score;
                    
                    setTimeout(() => {
                        grabbed = false;
                        targetX = canvas.width * (0.3 + Math.random() * 0.4);
                        targetY = canvas.height * (0.4 + Math.random() * 0.3);
                        document.getElementById('mascot-text').textContent = 'æ–°çš„ç›®æ ‡å‡ºç°äº†ï¼ç»§ç»­åŠ æ²¹ï¼';
                    }, 2000);
                }
            } else {
                // æŠ“å–åç›®æ ‡è·Ÿéšçˆªå­
                ctx.fillStyle = '#00ff00';
                ctx.fillRect(arm2EndX - 15, arm2EndY - 15, 30, 30);
            }
            
            requestAnimationFrame(drawRobot);
        }

        drawRobot();
    </script>
</body>
</html>
